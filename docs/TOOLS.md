# MCP å·¥å…·è¯¦è§£

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç» NeuroSpec æä¾›çš„æ‰€æœ‰ MCP å·¥å…·åŠå…¶å‚æ•°ã€‚

## ç›®å½•

- [interact - æ™ºèƒ½äº¤äº’](#interact---æ™ºèƒ½äº¤äº’)
- [memory - è®°å¿†ç®¡ç†](#memory---è®°å¿†ç®¡ç†)
- [search - ä»£ç æœç´¢](#search---ä»£ç æœç´¢)
- [é«˜çº§å·¥å…·](#é«˜çº§å·¥å…·)

---

## interact - æ™ºèƒ½äº¤äº’

è®© AI èƒ½å¤Ÿä¸ç”¨æˆ·è¿›è¡Œå¯Œæ–‡æœ¬äº¤äº’ï¼Œæ”¶é›†ç”¨æˆ·åé¦ˆã€‚

### å‚æ•°

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `message` | string | âœ… | è¦æ˜¾ç¤ºçš„æ¶ˆæ¯å†…å®¹ |
| `predefined_options` | string[] | âŒ | é¢„å®šä¹‰çš„é€‰é¡¹åˆ—è¡¨ |
| `is_markdown` | boolean | âŒ | æ˜¯å¦æ¸²æŸ“ Markdownï¼ˆé»˜è®¤ trueï¼‰ |

### è¯·æ±‚ç¤ºä¾‹

```json
{
  "message": "## æ£€æµ‹åˆ°å¤šä¸ªå®ç°æ–¹æ¡ˆ\n\nè¯·é€‰æ‹©æ‚¨åå¥½çš„æ–¹å¼ï¼š\n\n1. **æ–¹æ¡ˆA**: ä½¿ç”¨ç°æœ‰åº“ï¼Œå¼€å‘é€Ÿåº¦å¿«\n2. **æ–¹æ¡ˆB**: è‡ªå®šä¹‰å®ç°ï¼Œçµæ´»æ€§é«˜",
  "predefined_options": [
    "âœ… æ–¹æ¡ˆA: ä½¿ç”¨ç°æœ‰åº“",
    "ğŸ”§ æ–¹æ¡ˆB: è‡ªå®šä¹‰å®ç°",
    "ğŸ“‹ éœ€è¦æ›´å¤šä¿¡æ¯"
  ],
  "is_markdown": true
}
```

### å“åº”æ ¼å¼

```json
{
  "user_input": "ç”¨æˆ·çš„è‡ªç”±è¾“å…¥æ–‡æœ¬",
  "selected_options": ["ç”¨æˆ·é€‰æ‹©çš„é€‰é¡¹"],
  "images": [
    {
      "data": "base64ç¼–ç çš„å›¾ç‰‡æ•°æ®",
      "media_type": "image/png"
    }
  ],
  "metadata": {
    "timestamp": "2024-01-01T00:00:00Z",
    "request_id": "uuid",
    "source": "popup"
  }
}
```

### ä½¿ç”¨åœºæ™¯

- **ç¡®è®¤æ“ä½œ**ï¼šåœ¨æ‰§è¡Œå±é™©æ“ä½œå‰è¯¢é—®ç”¨æˆ·
- **é€‰æ‹©æ–¹æ¡ˆ**ï¼šè®©ç”¨æˆ·åœ¨å¤šä¸ªæŠ€æœ¯æ–¹æ¡ˆä¸­é€‰æ‹©
- **æ”¶é›†ä¿¡æ¯**ï¼šè·å–é¢å¤–çš„ä¸Šä¸‹æ–‡ä¿¡æ¯
- **å›¾ç‰‡è¾“å…¥**ï¼šç”¨æˆ·å¯ä»¥æ‹–æ‹½æˆªå›¾æä¾›è§†è§‰å‚è€ƒ

### æœ€ä½³å®è·µ

```json
{
  "message": "## ğŸš¨ NSP æ–½å·¥å›¾\n\n**ä¿®æ”¹èŒƒå›´**: 3 ä¸ªæ–‡ä»¶\n**é£é™©ç­‰çº§**: ä½\n\n```json\n{\"files\": [\"a.rs\", \"b.rs\"]}\n```\n\nç¡®è®¤æ‰§è¡Œï¼Ÿ",
  "predefined_options": ["âœ… ç¡®è®¤æ‰§è¡Œ", "âŒ å–æ¶ˆ", "ğŸ“ ä¿®æ”¹æ–¹æ¡ˆ"],
  "is_markdown": true
}
```

---

## memory - è®°å¿†ç®¡ç†

å­˜å‚¨å’Œå¬å›é¡¹ç›®çº§çš„å¼€å‘è§„åˆ™ã€åå¥½å’Œä¸Šä¸‹æ–‡ã€‚

### æ“ä½œç±»å‹

| Action | è¯´æ˜ |
|--------|------|
| `remember` | å­˜å‚¨æ–°è®°å¿† |
| `recall` | å¬å›ç›¸å…³è®°å¿† |
| `update` | æ›´æ–°ç°æœ‰è®°å¿† |
| `delete` | åˆ é™¤è®°å¿† |
| `list` | åˆ—å‡ºæ‰€æœ‰è®°å¿† |

### remember - å­˜å‚¨è®°å¿†

```json
{
  "action": "remember",
  "content": "æœ¬é¡¹ç›®ä½¿ç”¨ 4 ç©ºæ ¼ç¼©è¿›ï¼Œç¦æ­¢ä½¿ç”¨ any ç±»å‹",
  "category": "rule",
  "project_path": "/path/to/project"
}
```

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `action` | string | âœ… | å›ºå®šä¸º `remember` |
| `content` | string | âœ… | è®°å¿†å†…å®¹ |
| `category` | string | âœ… | åˆ†ç±»ï¼š`rule`/`preference`/`pattern`/`context` |
| `project_path` | string | âŒ | é¡¹ç›®è·¯å¾„ï¼ˆè‡ªåŠ¨æ£€æµ‹ Git æ ¹ç›®å½•ï¼‰ |

### recall - å¬å›è®°å¿†

```json
{
  "action": "recall",
  "context": "ä»£ç é£æ ¼ç›¸å…³è§„åˆ™",
  "project_path": "/path/to/project"
}
```

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `action` | string | âœ… | å›ºå®šä¸º `recall` |
| `context` | string | âŒ | ä¸Šä¸‹æ–‡å…³é”®è¯ï¼ˆç”¨äºè¯­ä¹‰åŒ¹é…ï¼‰ |
| `project_path` | string | âŒ | é¡¹ç›®è·¯å¾„ |

### è®°å¿†åˆ†ç±»

| Category | è¯´æ˜ | ç¤ºä¾‹ |
|----------|------|------|
| `rule` | å¼€å‘è§„åˆ™ | "ç¦æ­¢ä½¿ç”¨ eval()" |
| `preference` | ç”¨æˆ·åå¥½ | "åå¥½ä½¿ç”¨ Tailwind CSS" |
| `pattern` | ä»£ç æ¨¡å¼ | "ä½¿ç”¨ Repository æ¨¡å¼è®¿é—®æ•°æ®" |
| `context` | é¡¹ç›®ä¸Šä¸‹æ–‡ | "æŠ€æœ¯æ ˆï¼šVue 3 + Rust" |

### åˆ—å‡ºè®°å¿†

```json
{
  "action": "list",
  "category": "rule",
  "project_path": "/path/to/project",
  "page": 1,
  "page_size": 20
}
```

---

## search - ä»£ç æœç´¢

é«˜æ•ˆçš„ä»£ç æœç´¢å¼•æ“ï¼Œæ”¯æŒå…¨æ–‡æœç´¢å’Œç¬¦å·æœç´¢ã€‚

### å‚æ•°

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `query` | string | âœ… | æœç´¢æŸ¥è¯¢ |
| `mode` | string | âŒ | æœç´¢æ¨¡å¼ï¼ˆé»˜è®¤ `text`ï¼‰ |
| `project_root_path` | string | âŒ | é¡¹ç›®æ ¹è·¯å¾„ï¼ˆè‡ªåŠ¨æ£€æµ‹ï¼‰ |

### æœç´¢æ¨¡å¼

#### text - å…¨æ–‡æœç´¢

```json
{
  "query": "ç”¨æˆ·è®¤è¯é€»è¾‘",
  "mode": "text",
  "project_root_path": "/path/to/project"
}
```

è¿”å›ä¸æŸ¥è¯¢è¯­ä¹‰ç›¸å…³çš„ä»£ç ç‰‡æ®µã€‚

#### symbol - ç¬¦å·æœç´¢

```json
{
  "query": "handleLogin",
  "mode": "symbol",
  "project_root_path": "/path/to/project"
}
```

ç²¾ç¡®æŸ¥æ‰¾å‡½æ•°ã€ç±»ã€å˜é‡å®šä¹‰ã€‚

#### structure - é¡¹ç›®ç»“æ„

```json
{
  "query": "",
  "mode": "structure",
  "project_root_path": "/path/to/project"
}
```

è¿”å›é¡¹ç›®ç»“æ„æ¦‚è§ˆï¼š
- æ–‡ä»¶æ€»æ•°
- è¯­è¨€åˆ†å¸ƒ
- å…³é”®å…¥å£æ–‡ä»¶

### å“åº”æ ¼å¼

```
[Index: âœ… Ready | Files: 1234]
Found 5 relevant snippets (Mode: Text):

### ğŸ“„ `src/auth/login.rs` (Score: 0.95)
ğŸ“ impl AuthService â†’ login
ğŸ“ `pub async fn login(&self, credentials: Credentials) -> Result<Token>`
```rust
pub async fn login(&self, credentials: Credentials) -> Result<Token> {
    // éªŒè¯ç”¨æˆ·å‡­æ®
    let user = self.user_repo.find_by_email(&credentials.email).await?;
    // ...
}
```
```

### ç´¢å¼•æœºåˆ¶

- **é¦–æ¬¡æœç´¢**ï¼šè‡ªåŠ¨å»ºç«‹ç´¢å¼•ï¼ˆ10-30ç§’ï¼‰
- **å¢é‡æ›´æ–°**ï¼šæ£€æµ‹æ–‡ä»¶å˜åŒ–ï¼Œè‡ªåŠ¨æ›´æ–°ç´¢å¼•ï¼ˆ<1ç§’ï¼‰
- **ç¼“å­˜ä½ç½®**ï¼š`%LOCALAPPDATA%/neurospec/search_index/`

---

## é«˜çº§å·¥å…·

> âš ï¸ ä»¥ä¸‹å·¥å…·ä¸ºå®éªŒæ€§åŠŸèƒ½

### neurospec_graph_impact_analysis

åˆ†æç¬¦å·çš„ä¾èµ–å½±å“èŒƒå›´ï¼Œç”¨äºé‡æ„å‰è¯„ä¼°ã€‚

```json
{
  "symbol_name": "UserService",
  "project_root": "/path/to/project",
  "depth": 2
}
```

### neurospec_refactor_rename

è·¨æ–‡ä»¶å®‰å…¨é‡å‘½åç¬¦å·ã€‚

```json
{
  "old_name": "getUserById",
  "new_name": "findUserById",
  "file_path": "src/services/user.rs",
  "kind": "function",
  "project_root": "/path/to/project"
}
```

---

## å·¥å…·ç»„åˆä½¿ç”¨

### å…¸å‹å·¥ä½œæµ

1. **å¬å›è®°å¿†** â†’ äº†è§£é¡¹ç›®è§„èŒƒ
2. **æœç´¢ä»£ç ** â†’ å®šä½ç›¸å…³ä»£ç 
3. **äº¤äº’ç¡®è®¤** â†’ å±•ç¤ºæ–¹æ¡ˆå¹¶è·å–ç¡®è®¤
4. **æ‰§è¡Œä¿®æ”¹** â†’ æŒ‰ç…§ç¡®è®¤çš„æ–¹æ¡ˆæ‰§è¡Œ
5. **å­˜å‚¨è®°å¿†** â†’ è®°å½•æ–°çš„è§„åˆ™/æ¨¡å¼

### ç¤ºä¾‹

```
AI: è°ƒç”¨ memory.recall() è·å–é¡¹ç›®è§„åˆ™
AI: è°ƒç”¨ search() æŸ¥æ‰¾ç›¸å…³ä»£ç 
AI: è°ƒç”¨ interact() å±•ç¤ºä¿®æ”¹æ–¹æ¡ˆ
ç”¨æˆ·: é€‰æ‹©"ç¡®è®¤æ‰§è¡Œ"
AI: æ‰§è¡Œä»£ç ä¿®æ”¹
AI: è°ƒç”¨ memory.remember() å­˜å‚¨æ–°å‘ç°çš„æ¨¡å¼
```

---

å¦‚éœ€äº†è§£æ›´å¤šï¼Œè¯·å‚è€ƒ [æ¶æ„æ–‡æ¡£](ARCHITECTURE.md)ã€‚
